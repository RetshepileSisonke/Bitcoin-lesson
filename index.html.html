<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What is Money? ‚Äì Interactive Bitcoin Lesson</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;color:#333;}
.container{max-width:1100px;margin:0 auto;background:#fff;border-radius:20px;padding:32px;box-shadow:0 20px 60px rgba(0,0,0,.3);}
h1{text-align:center;color:#667eea;margin-bottom:10px;font-size:2.5em;font-weight:800;}
.subtitle{text-align:center;color:#666;margin-bottom:28px;font-size:1.05em;}
.progress-bar{width:100%;height:28px;background:#e0e0e0;border-radius:14px;overflow:hidden;margin-bottom:24px;}
.progress-fill{height:100%;background:linear-gradient(90deg,#667eea,#764ba2);width:0%;transition:width .5s;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:.9em;}
.game-area{display:none;}
.game-area.active{display:block;animation:fadeIn .4s;}
@keyframes fadeIn{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.intro-screen{text-align:center;padding:36px 16px;}
.intro-screen h2{color:#667eea;margin-bottom:16px;font-size:2em;font-weight:800;}
.intro-screen p{font-size:1.15em;line-height:1.8;margin-bottom:24px;color:#555;}
.btn{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:14px 38px;font-size:1.15em;border-radius:50px;cursor:pointer;transition:transform .2s,box-shadow .2s;font-weight:700;}
.btn:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(102,126,234,.5);}
.btn:active{transform:translateY(0);}
.btn-green{background:linear-gradient(135deg,#28a745,#20c997);}
.btn-orange{background:linear-gradient(135deg,#fd7e14,#e83e8c);}
.btn-gray{background:#6c757d;}
.stage-title{font-size:1.75em;color:#667eea;margin-bottom:16px;text-align:center;font-weight:800;}
.stage-desc{font-size:1.05em;color:#666;margin-bottom:24px;text-align:center;line-height:1.6;}
.trading-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:16px;margin-bottom:24px;}
.item-card{background:#f8f9fa;border:3px solid #e0e0e0;border-radius:14px;padding:18px;text-align:center;cursor:pointer;transition:all .3s;}
.item-card:hover{transform:scale(1.05);border-color:#667eea;}
.item-card.selected{border-color:#667eea;background:#f0f4ff;box-shadow:0 4px 14px rgba(102,126,234,.3);}
.item-icon{font-size:2.6em;margin-bottom:8px;}
.item-name{font-weight:700;margin-bottom:4px;}
.item-sub{color:#666;font-size:.88em;}
.quiz-opts{display:grid;gap:12px;margin-bottom:24px;}
.quiz-opt{background:#f8f9fa;border:2px solid #e0e0e0;border-radius:10px;padding:18px;cursor:pointer;transition:all .3s;text-align:left;}
.quiz-opt:hover{border-color:#667eea;background:#f0f4ff;}
.quiz-opt.correct{border-color:#28a745;background:#d4edda;}
.quiz-opt.incorrect{border-color:#dc3545;background:#f8d7da;}
.feedback{background:#fff3cd;border:2px solid #ffc107;border-radius:10px;padding:18px;margin-bottom:18px;display:none;}
.feedback.show{display:block;animation:fadeIn .4s;}
.feedback.success{background:#d4edda;border-color:#28a745;color:#155724;}
.feedback.error{background:#f8d7da;border-color:#dc3545;color:#721c24;}
.score-display{text-align:center;font-size:1.45em;color:#667eea;margin-bottom:18px;font-weight:700;}
.comp-screen{text-align:center;padding:36px 16px;}
.trophy{font-size:4.5em;margin-bottom:16px;}
.chars-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(190px,1fr));gap:14px;margin-bottom:24px;}
.char-card{background:#f8f9fa;border:2px solid #e0e0e0;border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all .3s;}
.char-card:hover{transform:scale(1.04);}
.char-card.selected{border-color:#667eea;background:#f0f4ff;}
.match-wrap{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px;}
.match-col{display:grid;gap:12px;}
.match-item{background:#f8f9fa;border:2px solid #e0e0e0;border-radius:10px;padding:14px;cursor:pointer;transition:all .3s;}
.match-item:hover{border-color:#667eea;}
.match-item.selected{border-color:#667eea;background:#f0f4ff;}
.match-item.matched{border-color:#28a745;background:#d4edda;cursor:default;}

/* ‚îÄ‚îÄ ELEGANT CROSSWORD ‚îÄ‚îÄ */
.cw-wrap{display:flex;flex-direction:column;align-items:center;gap:28px;}
.cw-scroll{overflow-x:auto;max-width:100%;padding-bottom:10px;}
.cw-grid{display:inline-grid;gap:1px;background:linear-gradient(135deg,#667eea,#764ba2);border:4px solid #667eea;border-radius:12px;padding:8px;box-shadow:0 10px 30px rgba(102,126,234,.35);}
.cw-cell{width:44px;height:44px;position:relative;border-radius:4px;transition:all .25s ease;}
.cw-cell.blk{background:linear-gradient(135deg,#2a2a3e,#1e1e2e);}
.cw-cell.wht{background:#fff;box-shadow:inset 0 1px 3px rgba(0,0,0,.1);}
.cw-cell.wht:hover{box-shadow:inset 0 1px 3px rgba(0,0,0,.1),0 0 0 3px rgba(102,126,234,.3);transform:scale(1.05);}
.cw-cell.wht.hi{background:linear-gradient(135deg,#e3f2ff,#cce5ff);box-shadow:inset 0 2px 4px rgba(102,126,234,.25);}
.cw-cell.wht.ok{background:linear-gradient(135deg,#d4f4dd,#b8f0cc) !important;box-shadow:inset 0 2px 4px rgba(40,167,69,.25),0 2px 8px rgba(40,167,69,.2) !important;}
.cw-cell.wht.err{background:linear-gradient(135deg,#ffe6e6,#ffd6d6) !important;box-shadow:inset 0 2px 4px rgba(220,53,69,.25),0 2px 8px rgba(220,53,69,.2) !important;}
.cw-cell.wht.rev{background:linear-gradient(135deg,#fffef0,#fff9c4) !important;box-shadow:inset 0 2px 4px rgba(255,193,7,.25),0 2px 8px rgba(255,193,7,.2) !important;}
.cw-num{position:absolute;top:3px;left:4px;font-size:10px;font-weight:800;color:#667eea;pointer-events:none;line-height:1;text-shadow:0 1px 2px rgba(255,255,255,.9);}
.cw-inp{width:100%;height:100%;border:none;outline:none;background:transparent;text-align:center;font-size:1.25em;font-weight:800;text-transform:uppercase;color:#2c2c2c;caret-color:transparent;cursor:pointer;padding:0;font-family:'Segoe UI',Tahoma,sans-serif;letter-spacing:1px;}
.clues-wrap{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:22px;margin-top:8px;}
.clue-col h3{color:#667eea;margin-bottom:14px;font-size:1.1em;border-bottom:3px solid #667eea;padding-bottom:8px;font-weight:800;text-transform:uppercase;letter-spacing:.8px;}
.clue-row{display:flex;gap:10px;padding:10px 12px;border-radius:9px;cursor:pointer;transition:all .25s;font-size:.94em;line-height:1.5;margin-bottom:6px;border:2px solid transparent;background:#fafbfc;}
.clue-row:hover{background:#f0f4ff;border-color:#d0e8ff;transform:translateX(3px);}
.clue-row.hi{background:linear-gradient(135deg,#e3f2ff,#d0e8ff);border-color:#667eea;box-shadow:0 3px 10px rgba(102,126,234,.25);}
.clue-row.done{color:#28a745;font-weight:700;background:#e8f5e9;border-color:#c3e6cb;}
.clue-row.done .cn{color:#28a745;}
.cn{font-weight:800;color:#667eea;min-width:26px;flex-shrink:0;font-size:1.08em;}
.cw-btns{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:6px;}
.cw-msg{text-align:center;font-size:1.2em;font-weight:700;min-height:30px;margin-top:10px;padding:8px;}
.cw-msg.good{color:#28a745;}
.cw-msg.bad{color:#dc3545;}
.cw-bar{background:linear-gradient(135deg,#f0f4ff,#e8f2ff);border:3px solid #667eea;border-radius:12px;padding:16px 24px;text-align:center;font-size:1.08em;color:#555;box-shadow:0 5px 15px rgba(102,126,234,.2);}
.cw-bar strong{color:#667eea;font-size:1.5em;font-weight:800;}

/* ‚îÄ‚îÄ REFERENCE GUIDE ‚îÄ‚îÄ */
.ref-guide{width:100%;background:linear-gradient(135deg,#f8f9ff,#f0f4ff);border:4px solid #667eea;border-radius:18px;padding:32px;margin-top:28px;box-shadow:0 10px 30px rgba(102,126,234,.2);}
.ref-guide h3{color:#667eea;font-size:1.6em;margin-bottom:10px;font-weight:800;text-align:center;text-transform:uppercase;letter-spacing:1px;}
.ref-guide .sub{color:#666;text-align:center;margin-bottom:28px;font-size:1.05em;line-height:1.6;}
.ref-sections{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;margin-top:24px;}
.ref-section{background:#fff;border:3px solid #e0e8ff;border-radius:14px;padding:24px;transition:all .3s;}
.ref-section:hover{border-color:#667eea;box-shadow:0 6px 20px rgba(102,126,234,.2);transform:translateY(-3px);}
.ref-section h4{color:#667eea;font-size:1.25em;margin-bottom:16px;font-weight:800;display:flex;align-items:center;gap:10px;text-transform:uppercase;letter-spacing:.5px;}
.ref-section h4 .icon{font-size:1.5em;}
.ref-item{margin-bottom:16px;padding-left:10px;border-left:4px solid #667eea;padding:10px 0 10px 14px;background:#fafbff;border-radius:4px;}
.ref-item strong{color:#333;display:block;margin-bottom:5px;font-size:1.02em;font-weight:700;}
.ref-item p{color:#666;font-size:.94em;line-height:1.7;margin:0;}
.ref-item .example{color:#764ba2;font-style:italic;margin-top:5px;font-size:.92em;font-weight:600;}
.toggle-ref{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:13px 32px;font-size:1.05em;border-radius:50px;cursor:pointer;margin:20px auto 0;display:block;font-weight:700;transition:all .25s;}
.toggle-ref:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(102,126,234,.5);}
.ref-guide.hidden{display:none;}

@media(max-width:750px){
  .match-wrap{grid-template-columns:1fr;}
  h1{font-size:2em;}
  .container{padding:16px;}
  .cw-cell{width:32px;height:32px;}
  .cw-inp{font-size:.95em;}
  .cw-num{font-size:7.5px;}
  .clues-wrap{grid-template-columns:1fr;}
  .ref-sections{grid-template-columns:1fr;}
}
</style>
</head>
<body>
<div class="container">
  <h1>üí∞ What is Money?</h1>
  <p class="subtitle">Mi Primer Bitcoin ¬∑ Chapter 2 ‚Äî Interactive Lesson &amp; Crossword Test</p>
  <div class="progress-bar"><div class="progress-fill" id="pBar">0%</div></div>
  <div class="score-display" id="scoreLbl">Score: 0 / 0</div>

  <!-- INTRO -->
  <div class="game-area active" id="stage0">
    <div class="intro-screen">
      <h2>üéØ Welcome, Bitcoin Learner!</h2>
      <p>Money is something we use every day ‚Äî but what <em>really</em> is it?</p>
      <ul style="text-align:left;max-width:600px;margin:10px auto 24px;font-size:1.12em;line-height:2.3;">
        <li>üìú The history of barter &amp; its problems</li>
        <li>‚ú® Properties that make good money</li>
        <li>üîÑ Evolution from shells ‚Üí gold ‚Üí paper ‚Üí digital</li>
        <li>‚Çø Why Bitcoin is the next step in money</li>
        <li>üß© A crossword to test everything you learned!</li>
      </ul>
      <button class="btn" onclick="go(1)">Start Learning! ‚Üí</button>
    </div>
  </div>

  <!-- STAGE 1: BARTER -->
  <div class="game-area" id="stage1">
    <h2 class="stage-title">Stage 1: Life Before Money üîÑ</h2>
    <p class="stage-desc">You're a farmer with <strong>üåæ wheat</strong>. You need <strong>üêü fish</strong>. Who do you try to trade with?</p>
    <div class="feedback" id="fb1"></div>
    <div class="trading-grid" id="barterGrid">
      <div class="item-card" onclick="pickB(this,'shoes')"><div class="item-icon">üëü</div><div class="item-name">Shoes</div><div class="item-sub">Shoemaker has these</div></div>
      <div class="item-card" onclick="pickB(this,'fish')"><div class="item-icon">üêü</div><div class="item-name">Fish</div><div class="item-sub">Fisherman has these</div></div>
      <div class="item-card" onclick="pickB(this,'pottery')"><div class="item-icon">üè∫</div><div class="item-name">Pottery</div><div class="item-sub">Potter has these</div></div>
      <div class="item-card" onclick="pickB(this,'cloth')"><div class="item-icon">üßµ</div><div class="item-name">Cloth</div><div class="item-sub">Weaver has these</div></div>
    </div>
    <div style="text-align:center;"><button class="btn" onclick="checkB()">Try This Trade!</button></div>
  </div>

  <!-- STAGE 2: BARTER PROBLEMS -->
  <div class="game-area" id="stage2">
    <h2 class="stage-title">Stage 2: Problems with Barter ü§î</h2>
    <p class="stage-desc">Click <strong>all three</strong> real problems that make barter difficult:</p>
    <div class="quiz-opts" id="bpOpts">
      <div class="quiz-opt" onclick="pickBP(this,true)"><strong>Double Coincidence of Wants</strong><p>You must find someone who has what you want AND wants what you have ‚Äî simultaneously.</p></div>
      <div class="quiz-opt" onclick="pickBP(this,true)"><strong>Divisibility Problem</strong><p>How do you split a live cow in half to pay for a loaf of bread?</p></div>
      <div class="quiz-opt" onclick="pickBP(this,true)"><strong>Storage &amp; Preservation</strong><p>Food rots. Animals need feeding. You can't easily save value for the future.</p></div>
      <div class="quiz-opt" onclick="pickBP(this,false)"><strong>It's Too Easy</strong><p>Barter makes every transaction simple and convenient for everyone.</p></div>
    </div>
    <div class="feedback" id="fb2"></div>
    <div style="text-align:center;"><button class="btn" onclick="go(3)">Continue ‚Üí</button></div>
  </div>

  <!-- STAGE 3: CHARACTERISTICS -->
  <div class="game-area" id="stage3">
    <h2 class="stage-title">Stage 3: What Makes Good Money? üíé</h2>
    <p class="stage-desc">Select <strong>all 6</strong> properties that good money must have:</p>
    <div class="chars-grid">
      <div class="char-card" onclick="togChar(this,'durable',true)"><div style="font-size:2em;margin-bottom:8px;">‚öôÔ∏è</div><strong>Durable</strong><p style="font-size:.9em;margin-top:5px;">Lasts a long time without decay</p></div>
      <div class="char-card" onclick="togChar(this,'portable',true)"><div style="font-size:2em;margin-bottom:8px;">üéí</div><strong>Portable</strong><p style="font-size:.9em;margin-top:5px;">Easy to carry around</p></div>
      <div class="char-card" onclick="togChar(this,'divisible',true)"><div style="font-size:2em;margin-bottom:8px;">‚úÇÔ∏è</div><strong>Divisible</strong><p style="font-size:.9em;margin-top:5px;">Can be split into smaller units</p></div>
      <div class="char-card" onclick="togChar(this,'fungible',true)"><div style="font-size:2em;margin-bottom:8px;">üîÑ</div><strong>Fungible</strong><p style="font-size:.9em;margin-top:5px;">Every unit is identical</p></div>
      <div class="char-card" onclick="togChar(this,'scarce',true)"><div style="font-size:2em;margin-bottom:8px;">üíé</div><strong>Scarce</strong><p style="font-size:.9em;margin-top:5px;">Limited supply</p></div>
      <div class="char-card" onclick="togChar(this,'recognizable',true)"><div style="font-size:2em;margin-bottom:8px;">‚úÖ</div><strong>Recognizable</strong><p style="font-size:.9em;margin-top:5px;">Easy to verify as genuine</p></div>
      <div class="char-card" onclick="togChar(this,'heavy',false)"><div style="font-size:2em;margin-bottom:8px;">ü™®</div><strong>Heavy</strong><p style="font-size:.9em;margin-top:5px;">Very difficult to move</p></div>
      <div class="char-card" onclick="togChar(this,'perishable',false)"><div style="font-size:2em;margin-bottom:8px;">ü•¨</div><strong>Perishable</strong><p style="font-size:.9em;margin-top:5px;">Decays or rots quickly</p></div>
    </div>
    <div class="feedback" id="fb3"></div>
    <div style="text-align:center;"><button class="btn" onclick="checkChars()">Check My Answers</button></div>
  </div>

  <!-- STAGE 4: MATCHING -->
  <div class="game-area" id="stage4">
    <h2 class="stage-title">Stage 4: The Evolution of Money üìà</h2>
    <p class="stage-desc">Match each type of money to its biggest limitation:</p>
    <div class="match-wrap">
      <div class="match-col">
        <h3 style="text-align:center;margin-bottom:12px;">üí± Type of Money</h3>
        <div class="match-item" onclick="pickM(this,'shells')" data-id="shells"><strong>üêö Shells &amp; Beads</strong><p>Early commodity money</p></div>
        <div class="match-item" onclick="pickM(this,'gold')" data-id="gold"><strong>ü•á Gold &amp; Silver</strong><p>Precious metal coins</p></div>
        <div class="match-item" onclick="pickM(this,'paper')" data-id="paper"><strong>üíµ Paper Money</strong><p>Government-issued notes</p></div>
        <div class="match-item" onclick="pickM(this,'digital')" data-id="digital"><strong>üí≥ Digital Fiat</strong><p>Electronic bank money</p></div>
      </div>
      <div class="match-col">
        <h3 style="text-align:center;margin-bottom:12px;">‚ö†Ô∏è Main Limitation</h3>
        <div class="match-item" onclick="pickM(this,'ns')" data-id="ns" data-ans="shells"><strong>Not Truly Scarce</strong><p>More could always be found on beaches</p></div>
        <div class="match-item" onclick="pickM(this,'heavy')" data-id="heavy" data-ans="gold"><strong>Heavy &amp; Hard to Transport</strong><p>Difficult for large transactions</p></div>
        <div class="match-item" onclick="pickM(this,'print')" data-id="print" data-ans="paper"><strong>Unlimited Printing</strong><p>Governments can create more at will</p></div>
        <div class="match-item" onclick="pickM(this,'central')" data-id="central" data-ans="digital"><strong>Centrally Controlled</strong><p>Banks and governments control access</p></div>
      </div>
    </div>
    <div class="feedback" id="fb4"></div>
    <div style="text-align:center;">
      <p style="margin-bottom:12px;color:#666;">Matches: <span id="mCount">0</span> / 4</p>
      <button class="btn" id="s4btn" style="display:none;" onclick="go(5)">Continue to Quiz ‚Üí</button>
    </div>
  </div>

  <!-- STAGE 5: QUIZ -->
  <div class="game-area" id="stage5">
    <h2 class="stage-title">Stage 5: Quick Understanding Check üéì</h2>
    <p class="stage-desc">Answer both questions correctly to unlock the crossword!</p>
    <div class="quiz-opts">
      <div style="margin-bottom:12px;"><strong style="font-size:1.12em;">Q1 ‚Äî What is the main purpose of money?</strong></div>
      <div class="quiz-opt" onclick="pickQ(this,1,false)">To give governments power over citizens</div>
      <div class="quiz-opt" onclick="pickQ(this,1,true)">To make trade easier and store value across time</div>
      <div class="quiz-opt" onclick="pickQ(this,1,false)">To create jobs in the banking sector</div>
    </div>
    <div class="quiz-opts" style="margin-top:22px;">
      <div style="margin-bottom:12px;"><strong style="font-size:1.12em;">Q2 ‚Äî Why is Bitcoin considered "sound money"?</strong></div>
      <div class="quiz-opt" onclick="pickQ(this,2,false)">Because it makes a sound when you send it</div>
      <div class="quiz-opt" onclick="pickQ(this,2,true)">Its supply is capped at 21 million ‚Äî making it scarce and inflation-resistant</div>
      <div class="quiz-opt" onclick="pickQ(this,2,false)">Because every government in the world accepts it</div>
    </div>
    <div class="feedback" id="fb5"></div>
    <div style="text-align:center;margin-top:24px;">
      <button class="btn" id="s5btn" style="display:none;" onclick="go(6)">üß© Take the Crossword Challenge!</button>
    </div>
  </div>

  <!-- STAGE 6: CROSSWORD -->
  <div class="game-area" id="stage6">
    <h2 class="stage-title">üß© Stage 6: Crossword Challenge</h2>
    <p class="stage-desc">Test everything you've learned! Click a clue or a cell and type your answer.<br><small>Use <kbd>Tab</kbd> to jump words ¬∑ Arrow keys to navigate ¬∑ <kbd>Backspace</kbd> to delete</small></p>
    <div class="cw-wrap">
      <div class="cw-scroll"><div class="cw-grid" id="cwGrid"></div></div>
      <div class="cw-btns">
        <button class="btn btn-green" onclick="cwCheck()">‚úÖ Check Answers</button>
        <button class="btn btn-orange" onclick="cwReveal()">üí° Reveal All</button>
        <button class="btn btn-gray" onclick="cwClear()">üîÑ Clear Grid</button>
      </div>
      <div class="cw-bar" id="cwBar" style="display:none;"></div>
      <div class="cw-msg" id="cwMsg"></div>
      <div class="clues-wrap" id="cwClues"></div>

      <!-- REFERENCE GUIDE -->
      <div class="ref-guide" id="refGuide">
        <h3>üìö Money Reference Guide</h3>
        <p class="sub">Understanding the Properties and Functions of Money</p>

        <div class="ref-sections">
          <!-- Properties Section -->
          <div class="ref-section">
            <h4><span class="icon">üíé</span> Properties of Money</h4>
            <div class="ref-item">
              <strong>Durable</strong>
              <p>Money must withstand physical wear and tear, lasting through repeated transactions without deteriorating.</p>
              <p class="example">Example: Gold coins last centuries; fresh fruit spoils in days.</p>
            </div>
            <div class="ref-item">
              <strong>Portable</strong>
              <p>Money should be easy to transport and carry, enabling trade across distances without excessive cost or difficulty.</p>
              <p class="example">Example: Paper bills fit in a wallet; carrying 50kg of gold bars does not.</p>
            </div>
            <div class="ref-item">
              <strong>Divisible</strong>
              <p>Money must be easily divided into smaller units to facilitate transactions of any size.</p>
              <p class="example">Example: $100 can become 10√ó$10 or 100√ó$1; a diamond cannot be easily split.</p>
            </div>
            <div class="ref-item">
              <strong>Fungible</strong>
              <p>Each unit of money must be interchangeable with any other identical unit ‚Äî one dollar equals any other dollar.</p>
              <p class="example">Example: Any $20 bill = any other $20 bill; houses are not fungible.</p>
            </div>
            <div class="ref-item">
              <strong>Scarce</strong>
              <p>Money must be limited in supply to maintain value. If supply can increase arbitrarily, value erodes.</p>
              <p class="example">Example: Bitcoin's 21M cap ensures scarcity; fiat can be printed infinitely.</p>
            </div>
            <div class="ref-item">
              <strong>Recognizable/Verifiable</strong>
              <p>Money must be easily identified as genuine and distinguished from counterfeits.</p>
              <p class="example">Example: Security features on bills; Bitcoin's cryptographic verification.</p>
            </div>
          </div>

          <!-- Functions Section -->
          <div class="ref-section">
            <h4><span class="icon">üîß</span> Functions of Money</h4>
            <div class="ref-item">
              <strong>Medium of Exchange</strong>
              <p>Money facilitates trade by acting as an intermediary between buyers and sellers, eliminating the need for barter.</p>
              <p class="example">Example: Instead of trading chickens for shoes, you sell chickens for money, then buy shoes with that money.</p>
            </div>
            <div class="ref-item">
              <strong>Unit of Account</strong>
              <p>Money provides a common measure of value, allowing us to price and compare different goods and services.</p>
              <p class="example">Example: A car costs $30,000, a coffee $3, rent $1,500/month ‚Äî all measured in the same unit.</p>
            </div>
            <div class="ref-item">
              <strong>Store of Value</strong>
              <p>Money preserves purchasing power over time, allowing people to save today and spend tomorrow.</p>
              <p class="example">Example: Saving $10,000 today to buy a car next year ‚Äî money holds value across time.</p>
            </div>
          </div>

          <!-- Bitcoin's Advantages -->
          <div class="ref-section">
            <h4><span class="icon">‚Çø</span> Bitcoin's Advantages</h4>
            <div class="ref-item">
              <strong>Fixed Supply</strong>
              <p>Bitcoin's supply is capped at 21 million coins forever. No government, bank, or person can create more.</p>
              <p class="example">Example: Unlike the USD which expanded 5√ó since 2000, Bitcoin's supply is mathematically limited.</p>
            </div>
            <div class="ref-item">
              <strong>Highly Divisible</strong>
              <p>Each bitcoin divides into 100 million satoshis, enabling transactions of any size from $0.0001 to billions.</p>
              <p class="example">Example: You can send 0.00000001 BTC (1 satoshi) across the world instantly.</p>
            </div>
            <div class="ref-item">
              <strong>Perfectly Portable</strong>
              <p>Bitcoin exists digitally. You can carry billions of dollars in your head via a 12-word seed phrase.</p>
              <p class="example">Example: Cross any border with $1M in Bitcoin using just memory ‚Äî no briefcase needed.</p>
            </div>
            <div class="ref-item">
              <strong>Decentralized</strong>
              <p>No single entity controls Bitcoin. It operates on a global network with no central point of failure.</p>
              <p class="example">Example: Banks can freeze your account; nobody can freeze your self-custodied Bitcoin.</p>
            </div>
          </div>
        </div>

        <button class="toggle-ref" onclick="toggleRef()">Hide Reference Guide ‚ñ≤</button>
      </div>
    </div>

    <div style="text-align:center;margin-top:28px;">
      <button class="btn" id="cwBtn" style="display:none;" onclick="go(7)">üèÜ See Final Results ‚Üí</button>
    </div>
  </div>

  <!-- COMPLETION -->
  <div class="game-area" id="stage7">
    <div class="comp-screen">
      <div class="trophy">üèÜ</div>
      <h2 style="color:#667eea;margin-bottom:16px;">Lesson Complete!</h2>
      <p style="font-size:1.25em;margin-bottom:20px;">You've finished <em>Chapter 2 ‚Äî What is Money?</em></p>
      <div id="finalScore" style="font-size:1.8em;color:#667eea;font-weight:700;margin-bottom:28px;"></div>
      <div style="background:#f8f9fa;padding:28px;border-radius:16px;margin-bottom:28px;text-align:left;">
        <h3 style="color:#667eea;margin-bottom:14px;">üîë Key Takeaways</h3>
        <ul style="font-size:1.05em;line-height:2.3;color:#555;">
          <li>üí± <strong>Barter</strong> fails due to double coincidence of wants, indivisibility &amp; storage problems</li>
          <li>‚ú® <strong>Good money</strong>: durable, portable, divisible, fungible, scarce, recognizable</li>
          <li>üîß <strong>Money's functions</strong>: medium of exchange, unit of account, store of value</li>
          <li>üìú Money evolved: <strong>Shells ‚Üí Gold ‚Üí Paper ‚Üí Digital fiat ‚Üí Bitcoin</strong></li>
          <li>‚Çø <strong>Bitcoin</strong> is digital (portable) + fixed 21M supply (scarce) + decentralised</li>
          <li>üîê Unlike fiat, Bitcoin <strong>cannot be inflated</strong> by any government or bank</li>
        </ul>
      </div>
      <button class="btn" onclick="restartAll()">‚Ü© Start Over</button>
    </div>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STATE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let curStage=0, score=0, ttl=0;
let bPick=null, chars={}, mState={sel:null,ok:0}, qA={1:false,2:false};

function go(n){
  document.querySelectorAll('.game-area').forEach(a=>a.classList.remove('active'));
  document.getElementById('stage'+n).classList.add('active');
  curStage=n;
  const pct=Math.round(n/7*100);
  document.getElementById('pBar').style.width=pct+'%';
  document.getElementById('pBar').textContent=pct+'%';
  if(n===6) cwInit();
  if(n===7){
    const p=ttl?Math.round(score/ttl*100):0;
    const m=p>=80?'ü•á':p>=60?'ü•à':'ü•â';
    document.getElementById('finalScore').innerHTML=m+' '+score+' / '+ttl+' ('+p+'%)';
  }
}
function upd(){document.getElementById('scoreLbl').textContent='Score: '+score+' / '+ttl;}

/* ‚îÄ‚îÄ Stage 1 ‚îÄ‚îÄ */
function pickB(el,v){
  document.querySelectorAll('#barterGrid .item-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected'); bPick=v;
}
function checkB(){
  const fb=document.getElementById('fb1');
  if(!bPick){fb.className='feedback show error';fb.textContent='Please select someone to trade with first!';return;}
  ttl++;
  if(bPick==='fish'){
    score++;
    fb.className='feedback show success';
    fb.innerHTML='<strong>Good thinking!</strong> But wait ‚Äî what if the fisherman doesn\'t want wheat? What if he wants shoes? This is the <em>double coincidence of wants</em> problem ‚Äî the core reason money was invented!';
  } else {
    fb.className='feedback show error';
    fb.innerHTML='<strong>That won\'t work directly.</strong> You want fish, not '+bPick+'. In barter you\'d need to find a chain of trades first ‚Äî exhausting! This is exactly why money was invented as a universal medium of exchange.';
  }
  upd();
  setTimeout(()=>{const b=document.createElement('button');b.className='btn';b.style.marginTop='14px';b.textContent='Continue ‚Üí';b.onclick=()=>go(2);fb.appendChild(b);},1800);
}

/* ‚îÄ‚îÄ Stage 2 ‚îÄ‚îÄ */
let bpCount=0;
function pickBP(el,correct){
  if(el.classList.contains('correct')||el.classList.contains('incorrect'))return;
  ttl++;
  if(correct){score++;el.classList.add('correct');bpCount++;}
  else el.classList.add('incorrect');
  upd();
  if(bpCount===3){
    const fb=document.getElementById('fb2');
    fb.className='feedback show success';
    fb.innerHTML='<strong>Excellent!</strong> All three barter problems found. Money was invented to solve each one!';
  }
}

/* ‚îÄ‚îÄ Stage 3 ‚îÄ‚îÄ */
function togChar(el,id,good){
  if(el.classList.contains('selected')){el.classList.remove('selected');delete chars[id];}
  else{el.classList.add('selected');chars[id]=good;}
}
function checkChars(){
  const fb=document.getElementById('fb3');
  const c=Object.values(chars).filter(v=>v).length,w=Object.values(chars).filter(v=>!v).length;
  ttl++;
  if(c===6&&w===0){
    score++;
    fb.className='feedback show success';
    fb.innerHTML='<strong>Perfect!</strong> All 6: Durable, Portable, Divisible, Fungible, Scarce, Recognizable. These are the properties Bitcoin was designed to maximise!<br><br><button class="btn" onclick="go(4)">Continue ‚Üí</button>';
  } else if(c>=4&&w===0){
    score+=.5;
    fb.className='feedback show';
    fb.innerHTML='<strong>Nearly there!</strong> '+c+'/6 correct. Full list: Durable, Portable, Divisible, Fungible, Scarce, Recognizable.<br><br><button class="btn" onclick="go(4)">Continue ‚Üí</button>';
  } else {
    fb.className='feedback show error';
    fb.innerHTML='<strong>Not quite.</strong> Good money needs: Durable, Portable, Divisible, Fungible, Scarce, Recognizable. Avoid Heavy or Perishable!<br><br><button class="btn" onclick="go(4)">Continue Anyway ‚Üí</button>';
  }
  upd();
}

/* ‚îÄ‚îÄ Stage 4 ‚îÄ‚îÄ */
function pickM(el,id){
  if(el.classList.contains('matched'))return;
  if(!mState.sel){
    document.querySelectorAll('.match-item.selected').forEach(i=>i.classList.remove('selected'));
    el.classList.add('selected'); mState.sel={el,id};
  } else {
    const f=mState.sel; el.classList.add('selected');
    const ans=el.dataset.ans||f.el.dataset.ans;
    const usr=el.dataset.ans?f.id:id;
    if(ans===usr){
      ttl++;score++;upd();
      setTimeout(()=>{
        f.el.classList.add('matched');el.classList.add('matched');
        f.el.classList.remove('selected');el.classList.remove('selected');
        mState.ok++;
        document.getElementById('mCount').textContent=mState.ok;
        if(mState.ok===4){
          const fb=document.getElementById('fb4');fb.className='feedback show success';
          fb.innerHTML='<strong>All matched!</strong> Bitcoin solves every limitation: digital (portable), 21M cap (scarce), peer-to-peer (decentralised).';
          document.getElementById('s4btn').style.display='inline-block';
        }
      },400);
    } else {
      setTimeout(()=>{f.el.classList.remove('selected');el.classList.remove('selected');},900);
    }
    mState.sel=null;
  }
}

/* ‚îÄ‚îÄ Stage 5 ‚îÄ‚îÄ */
function pickQ(el,q,correct){
  el.parentElement.querySelectorAll('.quiz-opt').forEach(s=>s.classList.remove('correct','incorrect'));
  ttl++;
  if(correct){score++;el.classList.add('correct');qA[q]=true;}
  else el.classList.add('incorrect');
  upd();
  if(qA[1]&&qA[2]){
    document.getElementById('s5btn').style.display='inline-block';
    const fb=document.getElementById('fb5');fb.className='feedback show success';
    fb.innerHTML='<strong>Outstanding!</strong> Solid understanding of money and Bitcoin. Now tackle the crossword! üß©';
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CROSSWORD
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const CW=[
  {w:'SCARCE',   r:0, c:0, d:'A',n:1,  clue:'Limited in supply ‚Äî a key property of sound money'},
  {w:'FIAT',     r:1, c:1, d:'A',n:3,  clue:'Money declared legal tender by a government decree'},
  {w:'FUNGIBLE', r:2, c:1, d:'A',n:4,  clue:'Every unit is interchangeable with any other unit'},
  {w:'MONEY',    r:3, c:1, d:'A',n:6,  clue:'Medium of exchange used to buy goods and services'},
  {w:'COIN',     r:4, c:0, d:'A',n:7,  clue:'Metal disc historically used as currency'},
  {w:'INFLATION',r:5, c:0, d:'A',n:8,  clue:'Rise in prices caused by too much money in circulation'},
  {w:'TRADE',    r:6, c:0, d:'A',n:9,  clue:'Exchange of goods, services, or value between people'},
  {w:'BARTER',   r:8, c:6, d:'A',n:11, clue:'Exchanging goods directly without using any money'},
  {w:'GOLD',     r:9, c:8, d:'A',n:12, clue:'Precious yellow metal used as money for centuries'},
  {w:'VALUE',    r:11,c:8, d:'A',n:13, clue:'What money represents and stores over time'},
  {w:'BITCOIN',  r:12,c:4, d:'A',n:14, clue:'Decentralised digital money with a fixed 21 million supply'},
  {w:'SCARCITY', r:0, c:0, d:'D',n:1,  clue:'Limited availability that gives something monetary worth'},
  {w:'DIVISIBLE',r:0, c:12,d:'D',n:2,  clue:'Can be split into smaller units (like satoshis)'},
  {w:'PORTABLE', r:4, c:7, d:'D',n:5,  clue:'Easy to carry from one place to another'},
  {w:'DURABLE',  r:6, c:3, d:'D',n:10, clue:'Resistant to decay ‚Äî money must last over time'},
];

const NR=13, NC=13;
let cwd=[], cwAct=null, cwDone=new Set(), _cwScored=false;

function cwInit(){
  cwd=[];
  for(let r=0;r<NR;r++){cwd[r]=[];for(let c=0;c<NC;c++) cwd[r][c]={blk:true,ans:'',val:'',num:0,ws:[]};}
  CW.forEach(w=>{
    for(let i=0;i<w.w.length;i++){
      const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
      cwd[r][c].blk=false; cwd[r][c].ans=w.w[i];
      cwd[r][c].ws.push({n:w.n,d:w.d});
      if(i===0) cwd[r][c].num=w.n;
    }
  });
  cwRender(); cwMakeClues();
}

function cwRender(){
  const g=document.getElementById('cwGrid');
  g.innerHTML=''; g.style.gridTemplateColumns='repeat('+NC+',44px)';
  for(let r=0;r<NR;r++) for(let c=0;c<NC;c++){
    const cell=cwd[r][c];
    const div=document.createElement('div');
    div.className='cw-cell '+(cell.blk?'blk':'wht');
    div.dataset.r=r; div.dataset.c=c;
    if(!cell.blk){
      if(cell.num){const s=document.createElement('span');s.className='cw-num';s.textContent=cell.num;div.appendChild(s);}
      const inp=document.createElement('input');
      inp.className='cw-inp'; inp.maxLength=1; inp.value=cell.val;
      inp.dataset.r=r; inp.dataset.c=c;
      inp.addEventListener('focus',()=>onFocus(r,c));
      inp.addEventListener('click',()=>onClick(r,c));
      inp.addEventListener('input',e=>onInput(e,r,c));
      inp.addEventListener('keydown',e=>onKey(e,r,c));
      div.appendChild(inp);
    }
    g.appendChild(div);
  }
}

function cwMakeClues(){
  const wrap=document.getElementById('cwClues');
  const A=CW.filter(x=>x.d==='A').sort((a,b)=>a.n-b.n);
  const D=CW.filter(x=>x.d==='D').sort((a,b)=>a.n-b.n);
  wrap.innerHTML=`
  <div class="clue-col">
    <h3>‚û°Ô∏è Across</h3>
    ${A.map(w=>`<div class="clue-row" id="cl-A-${w.n}" onclick="cwAct2(${w.n},'A')"><span class="cn">${w.n}.</span><span>${w.clue}</span></div>`).join('')}
  </div>
  <div class="clue-col">
    <h3>‚¨áÔ∏è Down</h3>
    ${D.map(w=>`<div class="clue-row" id="cl-D-${w.n}" onclick="cwAct2(${w.n},'D')"><span class="cn">${w.n}.</span><span>${w.clue}</span></div>`).join('')}
  </div>`;
}

function cwAct2(n,d){
  cwAct={n,d}; cwHL(); cwFocWord(n,d);
  const el=document.getElementById('cl-'+d+'-'+n);
  if(el) el.scrollIntoView({behavior:'smooth',block:'nearest'});
}

function cwFocWord(n,d){
  const w=CW.find(x=>x.n===n&&x.d===d); if(!w) return;
  for(let i=0;i<w.w.length;i++){
    const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
    if(!cwd[r][c].val){focCell(r,c);return;}
  }
  focCell(w.r,w.c);
}

function onClick(r,c){
  const cell=cwd[r][c]; if(!cell.ws.length) return;
  if(cwAct){
    const same=cell.ws.find(x=>x.n===cwAct.n&&x.d===cwAct.d);
    if(same) return;
    const other=cell.ws.find(x=>!(x.n===cwAct.n&&x.d===cwAct.d));
    cwAct=other||cell.ws[0];
  } else { cwAct=cell.ws[0]; }
  cwHL(); updClueHL();
}

function onFocus(r,c){
  const cell=cwd[r][c];
  if(!cwAct){ if(cell.ws.length) cwAct=cell.ws[0]; }
  else {
    const in_w=cell.ws.some(x=>x.n===cwAct.n&&x.d===cwAct.d);
    if(!in_w&&cell.ws.length) cwAct=cell.ws[0];
  }
  cwHL(); updClueHL();
}

function cwHL(){
  document.querySelectorAll('.cw-cell.wht').forEach(d=>d.classList.remove('hi'));
  document.querySelectorAll('.clue-row').forEach(c=>c.classList.remove('hi'));
  if(!cwAct) return;
  const w=CW.find(x=>x.n===cwAct.n&&x.d===cwAct.d); if(!w) return;
  for(let i=0;i<w.w.length;i++){
    const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
    const div=document.querySelector('.cw-cell[data-r="'+r+'"][data-c="'+c+'"]');
    if(div) div.classList.add('hi');
  }
  const cl=document.getElementById('cl-'+w.d+'-'+w.n);
  if(cl) cl.classList.add('hi');
}

function updClueHL(){
  if(!cwAct) return;
  const el=document.getElementById('cl-'+cwAct.d+'-'+cwAct.n);
  if(el) el.scrollIntoView({behavior:'smooth',block:'nearest'});
}

function focCell(r,c){
  const inp=document.querySelector('.cw-inp[data-r="'+r+'"][data-c="'+c+'"]');
  if(inp) inp.focus();
}

function onInput(e,r,c){
  const ch=e.target.value.replace(/[^a-zA-Z]/g,'').toUpperCase();
  e.target.value=ch.slice(-1); cwd[r][c].val=e.target.value;
  clrMark(r,c);
  document.getElementById('cwMsg').textContent='';
  if(e.target.value) cwAdv(r,c);
}

function onKey(e,r,c){
  if(e.key==='Backspace'){
    if(cwd[r][c].val){cwd[r][c].val='';e.target.value='';clrMark(r,c);}
    else cwRet(r,c);
    e.preventDefault();
  } else if(e.key==='ArrowRight'){mvCell(r,c+1);e.preventDefault();}
    else if(e.key==='ArrowLeft') {mvCell(r,c-1);e.preventDefault();}
    else if(e.key==='ArrowDown') {mvCell(r+1,c);e.preventDefault();}
    else if(e.key==='ArrowUp')   {mvCell(r-1,c);e.preventDefault();}
    else if(e.key==='Tab'){e.preventDefault();cwCycle(e.shiftKey);}
}

function cwAdv(r,c){
  if(!cwAct) return;
  const w=CW.find(x=>x.n===cwAct.n&&x.d===cwAct.d); if(!w) return;
  const i=w.d==='A'?c-w.c:r-w.r;
  if(i<w.w.length-1) focCell(w.d==='A'?r:r+1, w.d==='A'?c+1:c);
}
function cwRet(r,c){
  if(!cwAct) return;
  const w=CW.find(x=>x.n===cwAct.n&&x.d===cwAct.d); if(!w) return;
  const i=w.d==='A'?c-w.c:r-w.r;
  if(i>0) focCell(w.d==='A'?r:r-1, w.d==='A'?c-1:c);
}
function mvCell(r,c){
  if(r<0||r>=NR||c<0||c>=NC||cwd[r][c].blk) return;
  focCell(r,c);
}
function cwCycle(rev){
  const L=CW.map(x=>({n:x.n,d:x.d}));
  if(!cwAct){cwAct2(L[0].n,L[0].d);return;}
  const i=L.findIndex(x=>x.n===cwAct.n&&x.d===cwAct.d);
  const j=rev?(i-1+L.length)%L.length:(i+1)%L.length;
  cwAct2(L[j].n,L[j].d);
}
function clrMark(r,c){
  const d=document.querySelector('.cw-cell[data-r="'+r+'"][data-c="'+c+'"]');
  if(d) d.classList.remove('ok','err','rev');
}

function cwCheck(){
  let right=0,all=0; cwDone.clear();
  CW.forEach(w=>{
    let wOk=true;
    for(let i=0;i<w.w.length;i++){
      const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
      const cell=cwd[r][c];
      const div=document.querySelector('.cw-cell[data-r="'+r+'"][data-c="'+c+'"]');
      all++;
      if(cell.val===w.w[i]){right++;if(div){div.classList.remove('err','rev');div.classList.add('ok');}}
      else{wOk=false;if(div){div.classList.remove('ok','rev');div.classList.add('err');}}
    }
    if(wOk){
      cwDone.add(w.n+'-'+w.d);
      const cl=document.getElementById('cl-'+w.d+'-'+w.n);
      if(cl) cl.classList.add('done');
    }
  });
  const pct=Math.round(right/all*100);
  const bar=document.getElementById('cwBar');
  bar.style.display='block';
  bar.innerHTML='Letters correct: <strong>'+right+' / '+all+' ('+pct+'%)</strong>';
  const msg=document.getElementById('cwMsg');
  if(right===all){
    msg.className='cw-msg good';
    msg.textContent='üéâ Incredible! Every single letter is correct!';
    document.getElementById('cwBtn').style.display='inline-block';
    if(!_cwScored){_cwScored=true;ttl++;score++;upd();}
  } else if(pct>=70){
    msg.className='cw-msg bad';
    msg.textContent='So close! Fix the red cells. '+pct+'% correct.';
    document.getElementById('cwBtn').style.display='inline-block';
  } else {
    msg.className='cw-msg bad';
    msg.textContent=pct+'% correct ‚Äî red cells need fixing. Keep going!';
  }
}

function cwReveal(){
  CW.forEach(w=>{
    for(let i=0;i<w.w.length;i++){
      const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
      cwd[r][c].val=w.w[i];
      const inp=document.querySelector('.cw-inp[data-r="'+r+'"][data-c="'+c+'"]');
      const div=document.querySelector('.cw-cell[data-r="'+r+'"][data-c="'+c+'"]');
      if(inp) inp.value=w.w[i];
      if(div){div.classList.remove('ok','err');div.classList.add('rev');}
    }
    const cl=document.getElementById('cl-'+w.d+'-'+w.n);
    if(cl) cl.classList.add('done');
  });
  document.getElementById('cwMsg').className='cw-msg good';
  document.getElementById('cwMsg').textContent='All answers revealed ‚Äî study them and practice again!';
  document.getElementById('cwBar').style.display='none';
  document.getElementById('cwBtn').style.display='inline-block';
}

function cwClear(){
  CW.forEach(w=>{
    for(let i=0;i<w.w.length;i++){
      const r=w.d==='A'?w.r:w.r+i, c=w.d==='A'?w.c+i:w.c;
      cwd[r][c].val='';
      const inp=document.querySelector('.cw-inp[data-r="'+r+'"][data-c="'+c+'"]');
      const div=document.querySelector('.cw-cell[data-r="'+r+'"][data-c="'+c+'"]');
      if(inp) inp.value='';
      if(div) div.classList.remove('ok','err','rev');
    }
  });
  document.querySelectorAll('.clue-row').forEach(c=>c.classList.remove('done'));
  cwDone.clear(); _cwScored=false;
  document.getElementById('cwMsg').textContent='';
  document.getElementById('cwBar').style.display='none';
}

function toggleRef(){
  const g=document.getElementById('refGuide');
  const b=event.target;
  if(g.classList.contains('hidden')){
    g.classList.remove('hidden');
    b.textContent='Hide Reference Guide ‚ñ≤';
  } else {
    g.classList.add('hidden');
    b.textContent='Show Reference Guide ‚ñº';
  }
}

function restartAll(){
  score=0;ttl=0;bPick=null;chars={};bpCount=0;
  mState={sel:null,ok:0};qA={1:false,2:false};_cwScored=false;
  document.querySelectorAll('.quiz-opt,.item-card,.char-card,.match-item').forEach(e=>e.classList.remove('selected','correct','incorrect','matched'));
  document.querySelectorAll('.feedback').forEach(f=>{f.className='feedback';f.innerHTML='';});
  ['s4btn','s5btn','cwBtn'].forEach(id=>document.getElementById(id).style.display='none');
  document.getElementById('mCount').textContent='0';
  document.getElementById('refGuide').classList.remove('hidden');
  upd();
  document.querySelectorAll('.game-area').forEach(a=>a.classList.remove('active'));
  document.getElementById('stage0').classList.add('active');
  document.getElementById('pBar').style.width='0%';
  document.getElementById('pBar').textContent='0%';
}
upd();
</script>
</body>
</html>
